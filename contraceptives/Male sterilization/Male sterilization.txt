It’s almost 100% effective at preventing pregnancy.

It takes about 3 months for your semen to become sperm-free.
A few months after your vasectomy, your doctor will do a simple
test called a semen analysis to check for sperm in your semen.
You’ll masturbate into a cup or use a special condom when you
have sex to collect a semen sample. Your doctor will tell you when
there’s no sperm in your semen and the vasectomy is working as birth control.

It prevents pregnancy round the clock for the rest of your life. Vasectomies are
get-it-and-forget-it birth control. There’s a very slight chance that the cut
ends of your vas deferens can grow back together after a vasectomy, which means
you could cause a pregnancy.

Do vasectomies protect you from STDs?

No, a vasectomy won’t protect you or your partners from sexually transmitted infections.
Semen can still carry STDs, even if it doesn’t contain sperm.

Use a condom to help stop STDs.

Reference: https://www.plannedparenthood.org/learn/birth-control/vasectomy/how-effective-vasectomy